<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Pengeluaran - Redesign</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Custom Tailwind Config (inline untuk demo)
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            background: '#fafafa',
            surface: '#ffffff',
            border: {
              DEFAULT: '#e4e4e7',
              dark: '#d4d4d8',
            },
            text: {
              primary: '#18181b',
              secondary: '#52525b',
              muted: '#a1a1aa',
            },
            accent: {
              DEFAULT: '#4f46e5',
              hover: '#4338ca',
              pressed: '#3730a3',
              fg: '#ffffff',
              light: '#eef2ff',
            },
            destructive: {
              DEFAULT: '#dc2626',
              hover: '#b91c1c',
              fg: '#ffffff',
            },
            success: {
              DEFAULT: '#16a34a',
              light: '#f0fdf4',
            },
            warning: {
              DEFAULT: '#ea580c',
              light: '#fff7ed',
            },
          },
          spacing: {
            '2': '0.125rem',
            '6': '0.375rem',
            '12': '0.75rem',
            '16': '1rem',
            '24': '1.5rem',
            '32': '2rem',
          },
          boxShadow: {
            'xs': '0 1px 2px 0 rgb(0 0 0 / 0.05)',
            'sm': '0 1px 3px 0 rgb(0 0 0 / 0.08)',
            'md': '0 4px 6px -1px rgb(0 0 0 / 0.08)',
          },
        }
      }
    }
  </script>
  <style>
    /* Focus styles */
    button:focus-visible,
    a:focus-visible,
    input:focus-visible,
    select:focus-visible {
      outline: none;
      box-shadow: 0 0 0 2px white, 0 0 0 4px #4f46e5;
    }
    /* Hide number input arrows */
    input[type='number']::-webkit-inner-spin-button,
    input[type='number']::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type='number'] { -moz-appearance: textfield; }
  </style>
</head>
<body class="bg-background min-h-screen antialiased">

  <!-- Skip to main (a11y) -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-accent text-accent-fg px-16 py-8 rounded-lg z-50">
    Skip to main content
  </a>

  <!-- LOADING -->
  <div id="loading-section" class="flex items-center justify-center min-h-screen">
    <div class="text-center">
      <div class="animate-spin rounded-full h-48 w-48 border-4 border-accent border-t-transparent mx-auto mb-16"></div>
      <p class="text-text-secondary">Memuat aplikasi...</p>
    </div>
  </div>

  <!-- LOGIN -->
  <div id="login-section" class="hidden flex items-center justify-center min-h-screen px-16">
    <div class="bg-surface p-24 rounded-xl shadow-md border border-border w-full max-w-sm">
      <h2 class="text-xl font-semibold mb-16 text-center text-text-primary">Login Dashboard</h2>
      <div class="space-y-12">
        <div>
          <label for="email" class="block text-sm font-medium text-text-primary mb-6">Email</label>
          <input id="email" type="email" placeholder="nama@email.com"
            class="border border-border w-full px-12 py-8 rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150">
        </div>
        <div>
          <label for="password" class="block text-sm font-medium text-text-primary mb-6">Password</label>
          <input id="password" type="password" placeholder="••••••••"
            class="border border-border w-full px-12 py-8 rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150">
        </div>
        <button onclick="login()"
          class="bg-accent text-accent-fg w-full py-10 rounded-lg font-medium hover:bg-accent-hover active:bg-accent-pressed transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2">
          Masuk
        </button>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden">
    <!-- Header -->
    <header class="sticky top-0 z-20 bg-surface border-b border-border shadow-sm">
      <div class="max-w-7xl mx-auto px-16 py-16 flex justify-between items-center">
        <div>
          <h1 class="text-2xl font-bold text-text-primary">Dashboard Pengeluaran</h1>
          <p id="session-status" class="text-sm text-text-secondary mt-4">Kelola keuangan bulanan Anda</p>
        </div>
        <button onclick="logout()"
          class="bg-white text-text-primary border border-border px-16 py-8 rounded-lg text-sm font-medium hover:bg-zinc-50 active:bg-zinc-100 transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2">
          Logout
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="max-w-7xl mx-auto px-16 py-24">

      <!-- Mobile Layout: Stack -->
      <div class="lg:hidden space-y-24">

        <!-- Stat Cards -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-16" role="region" aria-label="Ringkasan Keuangan">
          <!-- Total Pengeluaran -->
          <div class="bg-surface rounded-xl border border-border shadow-sm p-16">
            <p class="text-sm font-medium text-text-secondary mb-8">Total Pengeluaran</p>
            <p id="totalPengeluaran" class="text-2xl font-bold text-text-primary">Rp 0</p>
          </div>

          <!-- Sisa Limit dengan Progress -->
          <div class="bg-surface rounded-xl border border-border shadow-sm p-16 sm:col-span-2">
            <div class="flex justify-between items-start mb-8">
              <div>
                <p class="text-sm font-medium text-text-secondary mb-8">Sisa Limit</p>
                <p id="sisaLimit" class="text-2xl font-bold text-text-primary">-</p>
              </div>
              <div class="text-right">
                <p class="text-sm text-text-muted mb-6">Utilisasi</p>
                <p id="utilisasi" class="text-xl font-bold text-text-primary">0%</p>
              </div>
            </div>
            <!-- Progress Bar -->
            <div class="w-full bg-zinc-100 rounded-full h-8 overflow-hidden">
              <div id="progressBar" class="h-full bg-success rounded-full transition-all duration-300 ease-out" style="width: 0%" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>

        <!-- Form Pengeluaran -->
        <div class="bg-surface rounded-xl border border-border shadow-sm">
          <div class="px-16 py-12 border-b border-border">
            <h2 class="text-lg font-semibold text-text-primary">Tambah Pengeluaran</h2>
          </div>
          <div class="p-16">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-16">
              <div>
                <label for="tanggal" class="block text-sm font-medium text-text-primary mb-6">
                  Tanggal <span class="text-destructive">*</span>
                </label>
                <input type="date" id="tanggal"
                  class="w-full px-12 py-8 text-base rounded-lg border border-border hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
              </div>
              <div>
                <label for="kategori" class="block text-sm font-medium text-text-primary mb-6">
                  Kategori <span class="text-destructive">*</span>
                </label>
                <select id="kategori"
                  class="w-full px-12 py-8 text-base rounded-lg border border-border hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150">
                  <option value="food & beverages">Food & Beverages</option>
                  <option value="entertainment">Entertainment</option>
                  <option value="groceries">Groceries</option>
                  <option value="transportation">Transportation</option>
                  <option value="health">Health</option>
                  <option value="utilities">Utilities</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="catatan" class="block text-sm font-medium text-text-primary mb-6">
                  Catatan <span class="text-destructive">*</span>
                </label>
                <input type="text" id="catatan" placeholder="Contoh: Makan siang di restoran"
                  class="w-full px-12 py-8 text-base rounded-lg border border-border hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
                <p class="text-xs text-text-muted mt-6">Deskripsi singkat transaksi</p>
              </div>
              <div>
                <label for="nominal" class="block text-sm font-medium text-text-primary mb-6">
                  Jumlah (Rp) <span class="text-destructive">*</span>
                </label>
                <input type="number" id="nominal" placeholder="Contoh: 50000"
                  class="w-full px-12 py-8 text-base rounded-lg border border-border hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
                <p class="text-xs text-text-muted mt-6">Masukkan tanpa titik atau koma</p>
              </div>
            </div>
            <button id="btnSimpan" onclick="tambahPengeluaran()"
              class="w-full md:w-auto bg-accent text-accent-fg px-24 py-12 rounded-xl font-medium text-lg hover:bg-accent-hover active:bg-accent-pressed transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 shadow-sm">
              Tambah Transaksi
            </button>
          </div>
        </div>

        <!-- Riwayat Transaksi -->
        <div class="bg-surface rounded-xl border border-border shadow-sm">
          <div class="px-16 py-12 border-b border-border">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-12">
              <h2 class="text-lg font-semibold text-text-primary">Riwayat Transaksi</h2>
              <div class="flex flex-col sm:flex-row gap-8 w-full sm:w-auto">
                <input type="month" id="filterBulan"
                  class="px-12 py-8 text-sm rounded-lg border border-border focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
                <select id="sortBy"
                  class="px-12 py-8 text-sm rounded-lg border border-border focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150">
                  <option value="date-desc" selected>Terbaru</option>
                  <option value="date-asc">Terlama</option>
                  <option value="amount-desc">Terbesar</option>
                  <option value="amount-asc">Terkecil</option>
                  <option value="category-asc">Kategori A-Z</option>
                </select>
              </div>
            </div>
          </div>
          <div class="overflow-x-auto">
            <table class="w-full border-collapse">
              <thead class="sticky top-0 bg-zinc-50 z-10">
                <tr>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Tanggal</th>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Kategori</th>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border hidden md:table-cell">Catatan</th>
                  <th class="px-16 py-12 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Jumlah</th>
                  <th class="px-16 py-12 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Aksi</th>
                </tr>
              </thead>
              <tbody id="tabelPengeluaran" class="bg-white divide-y divide-border">
                <tr>
                  <td colspan="5" class="text-center text-text-muted py-32">
                    <svg class="mx-auto h-48 w-48 text-text-muted mb-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <p class="text-base">Belum ada transaksi di bulan ini.</p>
                    <p class="text-sm mt-6">Tambahkan pengeluaran pertama Anda dengan formulir di atas.</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Limit Panel -->
        <div class="bg-surface rounded-xl border border-border shadow-sm">
          <div class="px-16 py-12 border-b border-border">
            <h2 class="text-lg font-semibold text-text-primary">Atur Limit Bulanan</h2>
          </div>
          <div class="p-16">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 mb-16">
              <div>
                <label for="bulan" class="block text-sm font-medium text-text-primary mb-6">Bulan <span class="text-destructive">*</span></label>
                <input type="month" id="bulan"
                  class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
              </div>
              <div>
                <label for="limit" class="block text-sm font-medium text-text-primary mb-6">Limit (Rp) <span class="text-destructive">*</span></label>
                <input type="number" id="limit" placeholder="Contoh: 5000000"
                  class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150"/>
              </div>
            </div>
            <div class="flex flex-col sm:flex-row gap-8">
              <button onclick="simpanLimit()"
                class="flex-1 sm:flex-none bg-accent text-accent-fg px-16 py-8 rounded-lg font-medium hover:bg-accent-hover transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2">
                Simpan Limit
              </button>
              <div class="relative">
                <button onclick="toggleSecondaryMenu()"
                  class="text-text-secondary hover:bg-zinc-100 px-12 py-8 rounded-lg transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 flex items-center gap-6">
                  <svg class="w-16 h-16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                  </svg>
                  Lainnya
                </button>
                <div id="secondaryMenu" class="hidden absolute left-0 mt-6 w-48 bg-white rounded-lg shadow-lg border border-border z-10">
                  <button onclick="eksporCSV(); toggleSecondaryMenu();"
                    class="w-full px-16 py-8 text-left text-sm text-text-primary hover:bg-zinc-50 rounded-t-lg transition-colors duration-150">
                    📊 Ekspor ke CSV
                  </button>
                  <button onclick="kirimEmail(); toggleSecondaryMenu();"
                    class="w-full px-16 py-8 text-left text-sm text-text-primary hover:bg-zinc-50 rounded-b-lg transition-colors duration-150 border-t border-border">
                    ✉️ Kirim ke Email
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Desktop Layout: 2 Column (hidden on mobile) -->
      <div class="hidden lg:grid lg:grid-cols-[360px_1fr] lg:gap-24">
        <!-- Sidebar -->
        <div class="space-y-24">
          <!-- Stats -->
          <div class="space-y-16">
            <div class="bg-surface rounded-xl border border-border shadow-sm p-16">
              <p class="text-sm font-medium text-text-secondary mb-8">Total Pengeluaran</p>
              <p id="totalPengeluaranDesktop" class="text-2xl font-bold text-text-primary">Rp 0</p>
            </div>
            <div class="bg-surface rounded-xl border border-border shadow-sm p-16">
              <div class="flex justify-between items-start mb-8">
                <div>
                  <p class="text-sm font-medium text-text-secondary mb-8">Sisa Limit</p>
                  <p id="sisaLimitDesktop" class="text-2xl font-bold text-text-primary">-</p>
                </div>
                <div class="text-right">
                  <p class="text-sm text-text-muted mb-6">Utilisasi</p>
                  <p id="utilisasiDesktop" class="text-xl font-bold text-text-primary">0%</p>
                </div>
              </div>
              <div class="w-full bg-zinc-100 rounded-full h-8 overflow-hidden">
                <div id="progressBarDesktop" class="h-full bg-success rounded-full transition-all duration-300 ease-out" style="width: 0%"></div>
              </div>
            </div>
          </div>

          <!-- Limit Panel Desktop -->
          <div class="bg-surface rounded-xl border border-border shadow-sm">
            <div class="px-16 py-12 border-b border-border">
              <h2 class="text-lg font-semibold text-text-primary">Atur Limit</h2>
            </div>
            <div class="p-16 space-y-12">
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Bulan</label>
                <input type="month" id="bulanDesktop" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              </div>
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Limit (Rp)</label>
                <input type="number" id="limitDesktop" placeholder="5000000" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              </div>
              <button onclick="simpanLimitDesktop()" class="w-full bg-accent text-accent-fg px-16 py-8 rounded-lg font-medium hover:bg-accent-hover transition-all duration-150">
                Simpan
              </button>
            </div>
          </div>

          <!-- Form Desktop -->
          <div class="bg-surface rounded-xl border border-border shadow-sm">
            <div class="px-16 py-12 border-b border-border">
              <h2 class="text-lg font-semibold text-text-primary">Tambah Pengeluaran</h2>
            </div>
            <div class="p-16 space-y-12">
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Tanggal</label>
                <input type="date" id="tanggalDesktop" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              </div>
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Kategori</label>
                <select id="kategoriDesktop" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent">
                  <option value="food & beverages">Food & Beverages</option>
                  <option value="entertainment">Entertainment</option>
                  <option value="groceries">Groceries</option>
                  <option value="transportation">Transportation</option>
                </select>
              </div>
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Catatan</label>
                <input type="text" id="catatanDesktop" placeholder="Deskripsi" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              </div>
              <div>
                <label class="block text-sm font-medium text-text-primary mb-6">Jumlah (Rp)</label>
                <input type="number" id="nominalDesktop" placeholder="50000" class="w-full px-12 py-8 rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              </div>
              <button onclick="tambahPengeluaranDesktop()" class="w-full bg-accent text-accent-fg px-16 py-10 rounded-lg font-medium hover:bg-accent-hover transition-all duration-150">
                Tambah
              </button>
            </div>
          </div>
        </div>

        <!-- Main Content Desktop: Table only -->
        <div class="bg-surface rounded-xl border border-border shadow-sm">
          <div class="px-16 py-12 border-b border-border flex justify-between items-center">
            <h2 class="text-lg font-semibold text-text-primary">Riwayat Transaksi</h2>
            <div class="flex gap-8">
              <input type="month" id="filterBulanDesktop" class="px-12 py-8 text-sm rounded-lg border border-border focus:ring-2 focus:ring-accent"/>
              <select id="sortByDesktop" class="px-12 py-8 text-sm rounded-lg border border-border focus:ring-2 focus:ring-accent">
                <option value="date-desc">Terbaru</option>
                <option value="date-asc">Terlama</option>
              </select>
            </div>
          </div>
          <div class="overflow-auto max-h-[calc(100vh-240px)]">
            <table class="w-full">
              <thead class="sticky top-0 bg-zinc-50">
                <tr>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase border-b border-border">Tanggal</th>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase border-b border-border">Kategori</th>
                  <th class="px-16 py-12 text-left text-xs font-semibold text-text-secondary uppercase border-b border-border">Catatan</th>
                  <th class="px-16 py-12 text-right text-xs font-semibold text-text-secondary uppercase border-b border-border">Jumlah</th>
                  <th class="px-16 py-12 text-right text-xs font-semibold text-text-secondary uppercase border-b border-border">Aksi</th>
                </tr>
              </thead>
              <tbody id="tabelPengeluaranDesktop" class="divide-y divide-border">
                <tr><td colspan="5" class="text-center py-32 text-text-muted">Belum ada data</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

    </main>
  </div>

  <script>
    // Toggle secondary menu
    function toggleSecondaryMenu() {
      const menu = document.getElementById('secondaryMenu');
      menu.classList.toggle('hidden');
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      const menu = document.getElementById('secondaryMenu');
      const button = event.target.closest('button');
      if (!button || !button.onclick || !button.onclick.toString().includes('toggleSecondaryMenu')) {
        menu?.classList.add('hidden');
      }
    });

    // Update progress bar color based on utilization
    function updateProgressColor(percentage) {
      const bars = [document.getElementById('progressBar'), document.getElementById('progressBarDesktop')];
      bars.forEach(bar => {
        if (!bar) return;
        bar.classList.remove('bg-success', 'bg-warning', 'bg-destructive');
        if (percentage >= 100) bar.classList.add('bg-destructive');
        else if (percentage >= 80) bar.classList.add('bg-warning');
        else bar.classList.add('bg-success');
      });
    }
  </script>

  <script type="module" src="js/app.js"></script>
</body>
</html>

