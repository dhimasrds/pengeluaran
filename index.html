<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Pengeluaran - Redesign</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  <script>
    // Custom Tailwind Config - Mercury.com Inspired Theme with Dark Mode
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            background: '#f8fafc',  // slate-50
            surface: '#ffffff',
            border: {
              DEFAULT: '#e2e8f0',  // slate-200
              dark: '#cbd5e1',     // slate-300
            },
            text: {
              primary: '#0f172a',  // slate-900
              secondary: '#475569', // slate-600
              muted: '#94a3b8',    // slate-400
            },
            accent: {
              DEFAULT: '#3b82f6',  // blue-500
              hover: '#2563eb',    // blue-600
              pressed: '#1d4ed8',  // blue-700
              fg: '#ffffff',
              light: '#eff6ff',    // blue-50
            },
            destructive: {
              DEFAULT: '#ef4444',
              hover: '#dc2626',
              fg: '#ffffff',
            },
            success: {
              DEFAULT: '#10b981',
              light: '#ecfdf5',
            },
            warning: {
              DEFAULT: '#f59e0b',
              light: '#fffbeb',
            },
            mercury: {
              blue: '#1e40af',
              lightBlue: '#3b82f6',
              gray: '#64748b',
              lightGray: '#f1f5f9',
            }
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
          spacing: {
            '2': '0.125rem',
            '6': '0.375rem',
            '12': '0.75rem',
            '16': '1rem',
            '24': '1.5rem',
            '32': '2rem',
          },
          boxShadow: {
            'xs': '0 1px 2px 0 rgb(0 0 0 / 0.05)',
            'sm': '0 1px 3px 0 rgb(0 0 0 / 0.1)',
            'md': '0 4px 6px -1px rgb(0 0 0 / 0.1)',
            'lg': '0 10px 15px -3px rgb(0 0 0 / 0.1)',
            'xl': '0 20px 25px -5px rgb(0 0 0 / 0.1)',
          },
        }
      }
    }
  </script>
  <style>
    /* Focus styles dengan Mercury Blue */
    button:focus-visible,
    a:focus-visible,
    input:focus-visible,
    select:focus-visible {
      outline: none;
      box-shadow: 0 0 0 2px white, 0 0 0 4px #3b82f6;
    }
    
    /* Hide number input arrows */
    input[type='number']::-webkit-inner-spin-button,
    input[type='number']::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    input[type='number'] { -moz-appearance: textfield; }

    /* Mercury.com inspired gradient background */
    .dashboard-bg {
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #eff6ff 100%);
    }

    /* Card dengan subtle gradient */
    .card-gradient {
      background: linear-gradient(135deg, #ffffff 0%, #fefefe 100%);
    }

    /* Stat card dengan accent background */
    .stat-card-accent {
      background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%);
      border-left: 4px solid #3b82f6;
    }

    /* Mercury.com style shadows */
    .mercury-shadow {
      box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px 0 rgb(0 0 0 / 0.06);
    }

    .mercury-shadow-lg {
      box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.05);
    }

    /* Smooth transitions */
    * {
      transition: all 0.2s ease-in-out;
    }

    /* Prevent horizontal overflow */
    html, body {
      max-width: 100vw;
      overflow-x: hidden;
    }

    /* Button pulse animation */
    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.02);
      }
    }

    .animate-pulse-slow {
      animation: pulse 2s ease-in-out infinite;
    }

    /* Card hover lift effect */
    .card-lift {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card-lift:hover {
      transform: translateY(-4px);
    }

    /* Fade in animation */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in {
      animation: fadeIn 0.5s ease-out;
    }

    /* Loading spinner */
    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .animate-spin {
      animation: spin 1s linear infinite;
    }
  </style>
</head>
<body class="min-h-screen antialiased font-sans overflow-x-hidden" style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #eff6ff 100%);">

  <!-- Skip to main (a11y) -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 bg-accent text-accent-fg px-16 py-8 rounded-lg z-50">
    Skip to main content
  </a>

  <!-- LOADING -->
  <div id="loading-section" class="flex items-center justify-center min-h-screen">
    <div class="text-center">
      <div class="animate-spin rounded-full h-48 w-48 border-4 border-accent border-t-transparent mx-auto mb-16"></div>
      <p class="text-text-secondary">Memuat aplikasi...</p>
    </div>
  </div>

  <!-- LOGIN -->
  <div id="login-section" class="hidden flex items-center justify-center min-h-screen px-16">
    <div class="bg-surface p-32 rounded-2xl mercury-shadow-lg border border-border w-full max-w-md">
      <div class="text-center mb-24">
        <div class="w-16 h-16 bg-accent rounded-xl mx-auto mb-16 flex items-center justify-center">
          <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
          </svg>
        </div>
        <h2 class="text-2xl font-semibold text-text-primary">Welcome Back</h2>
        <p class="text-text-secondary mt-6">Sign in to your expense dashboard</p>
      </div>
      <div class="space-y-16">
        <div>
          <label for="email" class="block text-sm font-medium text-text-primary mb-8">Email Address</label>
          <input id="email" type="email" placeholder="Enter your email"
            class="border border-border w-full px-16 py-12 rounded-xl focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 text-base">
        </div>
        <div>
          <label for="password" class="block text-sm font-medium text-text-primary mb-8">Password</label>
          <input id="password" type="password" placeholder="Enter your password"
            class="border border-border w-full px-16 py-12 rounded-xl focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 text-base">
        </div>
        <button onclick="login()"
          class="bg-accent text-accent-fg w-full py-12 rounded-xl font-semibold hover:bg-accent-hover active:bg-accent-pressed transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 text-base mercury-shadow">
          Sign In
        </button>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard" class="hidden bg-gradient-to-br from-slate-50 via-slate-100 to-blue-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 min-h-screen">
    <!-- Header -->
    <header class="sticky top-0 z-20 bg-surface/95 backdrop-blur-md border-b border-border mercury-shadow dark:bg-slate-900/95 dark:border-slate-700">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-5 flex flex-wrap justify-between items-center gap-4">
        <div class="flex items-center space-x-16">
          <div class="w-10 h-10 bg-accent rounded-xl flex items-center justify-center">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
          </div>
          <div>
            <h1 class="text-2xl font-bold text-text-primary dark:text-white">Expense Dashboard</h1>
            <p id="session-status" class="text-sm text-text-secondary dark:text-slate-400 mt-2">Manage your monthly finances</p>
          </div>
        </div>
        <div class="flex items-center gap-20">
          <!-- Dark Mode Toggle -->
          <div class="flex items-center gap-12 bg-white dark:bg-slate-800 border border-border dark:border-slate-600 rounded-xl p-6 mercury-shadow">
            <label class="flex items-center cursor-pointer">
              <input type="radio" name="theme" value="light" class="hidden peer/light" checked>
              <div class="flex items-center gap-6 px-12 py-8 rounded-lg transition-all peer-checked/light:bg-accent peer-checked/light:text-white text-text-secondary hover:bg-slate-100 dark:hover:bg-slate-700">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <span class="text-sm font-medium hidden sm:inline">Light</span>
              </div>
            </label>
            <label class="flex items-center cursor-pointer">
              <input type="radio" name="theme" value="dark" class="hidden peer/dark">
              <div class="flex items-center gap-6 px-12 py-8 rounded-lg transition-all peer-checked/dark:bg-accent peer-checked/dark:text-white text-text-secondary hover:bg-slate-100 dark:hover:bg-slate-700">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
                <span class="text-sm font-medium hidden sm:inline">Dark</span>
              </div>
            </label>
          </div>
          <button onclick="logout()"
            class="bg-white dark:bg-slate-800 text-text-primary dark:text-white border border-border dark:border-slate-600 px-20 py-10 rounded-xl text-sm font-medium hover:bg-slate-50 dark:hover:bg-slate-700 active:bg-slate-100 transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 mercury-shadow">
            <svg class="w-4 h-4 inline mr-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
            </svg>
            Sign Out
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main id="main-content" class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">

      <!-- Mobile Layout: Stack -->
      <div class="lg:hidden space-y-6">

        <!-- Stat Cards -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-20" role="region" aria-label="Financial Summary">
          <!-- Total Expenses -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow p-24 hover:shadow-lg transition-all duration-300">
            <div class="flex items-center justify-between mb-12">
              <div class="w-16 h-16 bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 rounded-xl flex items-center justify-center">
                <div id="lottie-expense" class="w-10 h-10"></div>
              </div>
            </div>
            <p class="text-sm font-medium text-text-secondary dark:text-slate-400 mb-8">Total Expenses</p>
            <p id="totalPengeluaran" class="text-3xl font-bold text-text-primary dark:text-white">Rp 0</p>
          </div>

          <!-- Remaining Limit with Progress -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow p-24 sm:col-span-2 hover:shadow-lg transition-all duration-300">
            <div class="flex justify-between items-start mb-16">
              <div>
                <p class="text-sm font-medium text-text-secondary dark:text-slate-400 mb-8">Remaining Budget</p>
                <p id="sisaLimit" class="text-3xl font-bold text-text-primary dark:text-white">-</p>
              </div>
              <div class="text-right">
                <p class="text-sm text-text-muted dark:text-slate-500 mb-6">Utilization</p>
                <p id="utilisasi" class="text-2xl font-bold text-text-primary dark:text-white">0%</p>
              </div>
            </div>
            <!-- Progress Bar -->
            <div class="w-full bg-slate-100 dark:bg-slate-700 rounded-full h-12 overflow-hidden">
              <div id="progressBar" class="h-full bg-accent rounded-full transition-all duration-500 ease-out" style="width: 0%" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
          </div>
        </div>

        <!-- Add Expense Form -->
        <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow hover:shadow-lg transition-all duration-300">
          <div class="px-24 py-20 border-b border-border dark:border-slate-700">
            <h2 class="text-xl font-semibold text-text-primary dark:text-white">Add New Expense</h2>
            <p class="text-text-secondary dark:text-slate-400 mt-4">Track your spending with detailed information</p>
          </div>
          <div class="p-24">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-20 mb-24">
              <div>
                <label for="tanggal" class="block text-sm font-medium text-text-primary dark:text-white mb-8">
                  Date <span class="text-destructive">*</span>
                </label>
                <input type="date" id="tanggal"
                  class="w-full px-16 py-12 text-base rounded-xl border border-border dark:border-slate-600 hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white"/>
              </div>
              <div>
                <label for="kategori" class="block text-sm font-medium text-text-primary dark:text-white mb-8">
                  Category <span class="text-destructive">*</span>
                </label>
                <select id="kategori"
                  class="w-full px-16 py-12 text-base rounded-xl border border-border dark:border-slate-600 hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white">
                  <option value="food & beverages">Food & Beverages</option>
                  <option value="entertainment">Entertainment</option>
                  <option value="groceries">Groceries</option>
                  <option value="transportation">Transportation</option>
                  <option value="health">Health</option>
                  <option value="utilities">Utilities</option>
                  <option value="other">Other</option>
                </select>
              </div>
              <div>
                <label for="catatan" class="block text-sm font-medium text-text-primary dark:text-white mb-8">
                  Description <span class="text-destructive">*</span>
                </label>
                <input type="text" id="catatan" placeholder="e.g., Lunch at restaurant"
                  class="w-full px-16 py-12 text-base rounded-xl border border-border dark:border-slate-600 hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
                <p class="text-xs text-text-muted dark:text-slate-500 mt-6">Brief description of the transaction</p>
              </div>
              <div>
                <label for="nominal" class="block text-sm font-medium text-text-primary dark:text-white mb-8">
                  Amount (Rp) <span class="text-destructive">*</span>
                </label>
                <input type="number" id="nominal" placeholder="e.g., 50000"
                  class="w-full px-16 py-12 text-base rounded-xl border border-border dark:border-slate-600 hover:border-border-dark focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
                <p class="text-xs text-text-muted dark:text-slate-500 mt-6">Enter amount without dots or commas</p>
              </div>
            </div>
            <button id="btnSimpan" onclick="tambahPengeluaran()"
              class="w-full md:w-auto bg-accent text-accent-fg px-32 py-16 rounded-xl font-semibold text-lg hover:bg-accent-hover active:bg-accent-pressed transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 mercury-shadow">
              <svg class="w-5 h-5 inline mr-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
              </svg>
              Add Expense
            </button>
          </div>
        </div>

        <!-- Transaction History -->
        <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow">
          <div class="px-24 py-20 border-b border-border dark:border-slate-700">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-16">
              <div>
                <h2 class="text-xl font-semibold text-text-primary dark:text-white">Transaction History</h2>
                <p class="text-text-secondary dark:text-slate-400 mt-4">View and manage your expense records</p>
              </div>
              <div class="flex flex-col sm:flex-row gap-12 w-full sm:w-auto">
                <input type="month" id="filterBulan"
                  class="px-16 py-12 text-sm rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white"/>
                <select id="sortBy"
                  class="px-16 py-12 text-sm rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white">
                  <option value="date-desc" selected>Latest</option>
                  <option value="date-asc">Oldest</option>
                  <option value="amount-desc">Highest</option>
                  <option value="amount-asc">Lowest</option>
                  <option value="category-asc">Category A-Z</option>
                </select>
              </div>
            </div>
          </div>
          <div class="overflow-x-auto -mx-4 px-4">
            <table class="w-full min-w-full border-collapse">
              <thead class="sticky top-0 bg-slate-50 dark:bg-slate-900 z-10">
                <tr>
                  <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary dark:text-slate-400 uppercase tracking-wider border-b border-border dark:border-slate-700">Date</th>
                  <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary dark:text-slate-400 uppercase tracking-wider border-b border-border dark:border-slate-700">Category</th>
                  <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary dark:text-slate-400 uppercase tracking-wider border-b border-border dark:border-slate-700 hidden md:table-cell">Description</th>
                  <th class="px-20 py-16 text-right text-xs font-semibold text-text-secondary dark:text-slate-400 uppercase tracking-wider border-b border-border dark:border-slate-700">Amount</th>
                  <th class="px-20 py-16 text-right text-xs font-semibold text-text-secondary dark:text-slate-400 uppercase tracking-wider border-b border-border dark:border-slate-700">Actions</th>
                </tr>
              </thead>
              <tbody id="tabelPengeluaran" class="bg-white dark:bg-slate-800 divide-y divide-border dark:divide-slate-700">
                <tr>
                  <td colspan="5" class="text-center text-text-muted py-40">
                    <svg class="mx-auto h-16 w-16 text-text-muted mb-20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <p class="text-lg font-medium">No transactions this month</p>
                    <p class="text-sm mt-6">Add your first expense using the form above</p>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Budget Limit Panel -->
        <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow hover:shadow-lg transition-all duration-300">
          <div class="px-24 py-20 border-b border-border dark:border-slate-700">
            <h2 class="text-xl font-semibold text-text-primary dark:text-white">Set Monthly Budget</h2>
            <p class="text-text-secondary dark:text-slate-400 mt-4">Define your spending limit for better financial control</p>
          </div>
          <div class="p-24">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-20 mb-24">
              <div>
                <label for="bulan" class="block text-sm font-medium text-text-primary dark:text-white mb-8">Month <span class="text-destructive">*</span></label>
                <input type="month" id="bulan"
                  class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white"/>
              </div>
              <div>
                <label for="limit" class="block text-sm font-medium text-text-primary dark:text-white mb-8">Budget Limit (Rp) <span class="text-destructive">*</span></label>
                <input type="number" id="limit" placeholder="e.g., 5000000"
                  class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-150 dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
              </div>
            </div>
            <div class="flex flex-col sm:flex-row gap-12">
              <button onclick="simpanLimit()"
                class="flex-1 sm:flex-none bg-accent text-accent-fg px-24 py-12 rounded-xl font-semibold hover:bg-accent-hover transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 mercury-shadow">
                <svg class="w-5 h-5 inline mr-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Save Budget
              </button>
              <div class="relative">
                <button onclick="toggleSecondaryMenu()"
                  class="text-text-secondary dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-700 px-16 py-12 rounded-xl transition-all duration-150 focus:ring-2 focus:ring-accent focus:ring-offset-2 flex items-center gap-8">
                  <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z" />
                  </svg>
                  More Options
                </button>
                <div id="secondaryMenu" class="hidden absolute left-0 mt-8 w-56 bg-white dark:bg-slate-800 rounded-xl mercury-shadow-lg border border-border dark:border-slate-700 z-10">
                  <button onclick="eksporCSV(); toggleSecondaryMenu();"
                    class="w-full px-20 py-12 text-left text-sm text-text-primary dark:text-white hover:bg-slate-50 dark:hover:bg-slate-700 rounded-t-xl transition-colors duration-150 flex items-center gap-8">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                    Export to CSV
                  </button>
                  <button onclick="kirimEmail(); toggleSecondaryMenu();"
                    class="w-full px-20 py-12 text-left text-sm text-text-primary dark:text-white hover:bg-slate-50 dark:hover:bg-slate-700 rounded-b-xl transition-colors duration-150 border-t border-border dark:border-slate-700 flex items-center gap-8">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                    Send via Email
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Desktop Layout: Improved symmetric layout (hidden on mobile) -->
      <div class="hidden lg:block">
        <!-- Stats Row at Top (Always Visible) -->
        <div class="grid grid-cols-3 gap-20 mb-24">
          <!-- Total Expenses -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow p-24 hover:shadow-lg transition-all duration-300">
            <div class="flex items-center justify-between mb-12">
              <div class="w-16 h-16 bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 rounded-xl flex items-center justify-center">
                <div id="lottie-expense-desktop" class="w-10 h-10"></div>
              </div>
            </div>
            <p class="text-sm font-medium text-text-secondary dark:text-slate-400 mb-8">Total Expenses</p>
            <p id="totalPengeluaranDesktop" class="text-3xl font-bold text-text-primary dark:text-white">Rp 0</p>
          </div>

          <!-- Remaining Budget -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow p-24 hover:shadow-lg transition-all duration-300">
            <div class="flex items-center justify-between mb-12">
              <div class="w-16 h-16 bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl flex items-center justify-center">
                <div id="lottie-budget-desktop" class="w-10 h-10"></div>
              </div>
            </div>
            <p class="text-sm font-medium text-text-secondary dark:text-slate-400 mb-8">Remaining Budget</p>
            <p id="sisaLimitDesktop" class="text-3xl font-bold text-text-primary dark:text-white">-</p>
          </div>

          <!-- Utilization with Progress -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow p-24 hover:shadow-lg transition-all duration-300">
            <div class="flex justify-between items-center mb-12">
              <div class="w-16 h-16 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl flex items-center justify-center">
                <div id="lottie-chart-desktop" class="w-10 h-10"></div>
              </div>
              <div class="text-right">
                <p id="utilisasiDesktop" class="text-2xl font-bold text-text-primary dark:text-white">0%</p>
              </div>
            </div>
            <p class="text-sm font-medium text-text-secondary dark:text-slate-400 mb-12">Budget Utilization</p>
            <div class="w-full bg-slate-100 dark:bg-slate-700 rounded-full h-12 overflow-hidden">
              <div id="progressBarDesktop" class="h-full bg-accent rounded-full transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <!-- Two Column Layout: Forms + Table -->
        <div class="grid lg:grid-cols-[minmax(320px,_400px)_1fr] gap-6 xl:gap-8">
          <!-- Left Sidebar: Forms -->
          <div class="space-y-6">
            <!-- Budget Panel Desktop -->
            <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow hover:shadow-lg transition-all duration-300">
              <div class="px-20 py-16 border-b border-border dark:border-slate-700">
                <h2 class="text-lg font-semibold text-text-primary dark:text-white">Set Budget</h2>
              </div>
              <div class="p-20 space-y-16">
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Month</label>
                  <input type="month" id="bulanDesktop" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Limit (Rp)</label>
                  <input type="number" id="limitDesktop" placeholder="5000000" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
                </div>
                <button onclick="simpanLimitDesktop()" class="w-full bg-accent text-accent-fg px-20 py-12 rounded-xl font-semibold hover:bg-accent-hover transition-all duration-150 mercury-shadow">
                  Save Budget
                </button>
              </div>
            </div>

            <!-- Add Expense Form Desktop -->
            <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow hover:shadow-lg transition-all duration-300">
              <div class="px-20 py-16 border-b border-border dark:border-slate-700">
                <h2 class="text-lg font-semibold text-text-primary dark:text-white">Add Expense</h2>
              </div>
              <div class="p-20 space-y-16">
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Date</label>
                  <input type="date" id="tanggalDesktop" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Category</label>
                  <select id="kategoriDesktop" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white">
                    <option value="food & beverages">Food & Beverages</option>
                    <option value="entertainment">Entertainment</option>
                    <option value="groceries">Groceries</option>
                    <option value="transportation">Transportation</option>
                    <option value="health">Health</option>
                    <option value="utilities">Utilities</option>
                    <option value="other">Other</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Description</label>
                  <input type="text" id="catatanDesktop" placeholder="Brief description" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
                </div>
                <div>
                  <label class="block text-sm font-medium text-text-primary dark:text-white mb-8">Amount (Rp)</label>
                  <input type="number" id="nominalDesktop" placeholder="50000" class="w-full px-16 py-12 rounded-xl border border-border dark:border-slate-600 focus:ring-2 focus:ring-accent dark:bg-slate-900 dark:text-white dark:placeholder-slate-500"/>
                </div>
                <button onclick="tambahPengeluaranDesktop()" class="w-full bg-accent text-accent-fg px-20 py-12 rounded-xl font-semibold hover:bg-accent-hover transition-all duration-150 mercury-shadow">
                  Add Expense
                </button>
              </div>
            </div>
          </div>

          <!-- Right Content: Table -->
          <div class="bg-surface dark:bg-slate-800 rounded-2xl border border-border dark:border-slate-700 mercury-shadow hover:shadow-lg transition-all duration-300 overflow-hidden">
            <div class="px-24 py-20 border-b border-border dark:border-slate-700 flex justify-between items-center">
              <div>
                <h2 class="text-xl font-semibold text-text-primary dark:text-white">Transaction History</h2>
                <p class="text-text-secondary dark:text-slate-400 mt-4">View and manage your expense records</p>
              </div>
              <div class="flex gap-12">
                <input type="month" id="filterBulanDesktop" class="px-16 py-12 text-sm rounded-xl border border-border focus:ring-2 focus:ring-accent dark:bg-slate-800 dark:border-slate-600 dark:text-white"/>
                <select id="sortByDesktop" class="px-16 py-12 text-sm rounded-xl border border-border focus:ring-2 focus:ring-accent dark:bg-slate-800 dark:border-slate-600 dark:text-white">
                  <option value="date-desc">Latest</option>
                  <option value="date-asc">Oldest</option>
                  <option value="amount-desc">Highest</option>
                  <option value="amount-asc">Lowest</option>
                  <option value="category-asc">Category A-Z</option>
                </select>
              </div>
            </div>
            <div class="overflow-auto max-h-[calc(100vh-340px)] scrollbar-thin">
              <table class="w-full min-w-full">
                <thead class="sticky top-0 bg-slate-50 dark:bg-slate-800">
                  <tr>
                    <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Date</th>
                    <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Category</th>
                    <th class="px-20 py-16 text-left text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Description</th>
                    <th class="px-20 py-16 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Amount</th>
                    <th class="px-20 py-16 text-right text-xs font-semibold text-text-secondary uppercase tracking-wider border-b border-border">Actions</th>
                  </tr>
                </thead>
                <tbody id="tabelPengeluaranDesktop" class="divide-y divide-border dark:divide-slate-700">
                  <tr><td colspan="5" class="text-center py-40 text-text-muted">No data available</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>

  <script>
    // Toggle secondary menu
    function toggleSecondaryMenu() {
      const menu = document.getElementById('secondaryMenu');
      menu.classList.toggle('hidden');
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
      const menu = document.getElementById('secondaryMenu');
      const button = event.target.closest('button');
      if (!button || !button.onclick || !button.onclick.toString().includes('toggleSecondaryMenu')) {
        menu?.classList.add('hidden');
      }
    });

    // Update progress bar color based on utilization
    function updateProgressColor(percentage) {
      const bars = [document.getElementById('progressBar'), document.getElementById('progressBarDesktop')];
      bars.forEach(bar => {
        if (!bar) return;
        bar.classList.remove('bg-success', 'bg-warning', 'bg-destructive', 'bg-accent');
        if (percentage >= 100) bar.classList.add('bg-destructive');
        else if (percentage >= 80) bar.classList.add('bg-warning');
        else bar.classList.add('bg-accent');
      });
    }

    // Initialize Lottie Animations
    function initLottieAnimations() {
      // Expense icon - money with arrow down
      const expenseAnimation = {
        "v": "5.7.4",
        "fr": 60,
        "ip": 0,
        "op": 120,
        "w": 100,
        "h": 100,
        "nm": "Money Down",
        "ddd": 0,
        "assets": [],
        "layers": [{
          "ddd": 0,
          "ind": 1,
          "ty": 4,
          "nm": "Circle",
          "sr": 1,
          "ks": {
            "o": {"a": 0, "k": 100},
            "r": {"a": 1, "k": [{"t": 0, "s": [0], "e": [360]}, {"t": 120}]},
            "p": {"a": 0, "k": [50, 50, 0]},
            "a": {"a": 0, "k": [0, 0, 0]},
            "s": {"a": 1, "k": [{"t": 0, "s": [80, 80, 100], "e": [100, 100, 100]}, {"t": 30, "s": [100, 100, 100], "e": [80, 80, 100]}, {"t": 60}]}
          },
          "ao": 0,
          "shapes": [{
            "ty": "gr",
            "it": [{
              "d": 1,
              "ty": "el",
              "s": {"a": 0, "k": [60, 60]},
              "p": {"a": 0, "k": [0, 0]},
              "nm": "Circle Path"
            }, {
              "ty": "st",
              "c": {"a": 0, "k": [0.937, 0.322, 0.322, 1]},
              "o": {"a": 0, "k": 100},
              "w": {"a": 0, "k": 4},
              "lc": 2,
              "lj": 2,
              "nm": "Stroke"
            }, {
              "ty": "tr",
              "p": {"a": 0, "k": [0, 0]},
              "a": {"a": 0, "k": [0, 0]},
              "s": {"a": 0, "k": [100, 100]},
              "r": {"a": 0, "k": 0},
              "o": {"a": 0, "k": 100}
            }],
            "nm": "Circle Group"
          }]
        }]
      };

      // Budget icon - wallet animation
      const budgetAnimation = {
        "v": "5.7.4",
        "fr": 60,
        "ip": 0,
        "op": 120,
        "w": 100,
        "h": 100,
        "nm": "Wallet",
        "ddd": 0,
        "assets": [],
        "layers": [{
          "ddd": 0,
          "ind": 1,
          "ty": 4,
          "nm": "Wallet Shape",
          "sr": 1,
          "ks": {
            "o": {"a": 0, "k": 100},
            "r": {"a": 1, "k": [{"t": 0, "s": [0], "e": [10]}, {"t": 30, "s": [10], "e": [-10]}, {"t": 60, "s": [-10], "e": [0]}, {"t": 90}]},
            "p": {"a": 0, "k": [50, 50, 0]},
            "a": {"a": 0, "k": [0, 0, 0]},
            "s": {"a": 0, "k": [100, 100, 100]}
          },
          "ao": 0,
          "shapes": [{
            "ty": "gr",
            "it": [{
              "ty": "rc",
              "d": 1,
              "s": {"a": 0, "k": [50, 35]},
              "p": {"a": 0, "k": [0, 0]},
              "r": {"a": 0, "k": 8},
              "nm": "Rectangle"
            }, {
              "ty": "st",
              "c": {"a": 0, "k": [0.133, 0.694, 0.298, 1]},
              "o": {"a": 0, "k": 100},
              "w": {"a": 0, "k": 4},
              "lc": 2,
              "lj": 2,
              "nm": "Stroke"
            }, {
              "ty": "tr",
              "p": {"a": 0, "k": [0, 0]},
              "a": {"a": 0, "k": [0, 0]},
              "s": {"a": 0, "k": [100, 100]},
              "r": {"a": 0, "k": 0},
              "o": {"a": 0, "k": 100}
            }],
            "nm": "Wallet Group"
          }]
        }]
      };

      // Chart icon - animated bars
      const chartAnimation = {
        "v": "5.7.4",
        "fr": 60,
        "ip": 0,
        "op": 120,
        "w": 100,
        "h": 100,
        "nm": "Chart",
        "ddd": 0,
        "assets": [],
        "layers": [{
          "ddd": 0,
          "ind": 1,
          "ty": 4,
          "nm": "Bar 1",
          "sr": 1,
          "ks": {
            "o": {"a": 0, "k": 100},
            "r": {"a": 0, "k": 0},
            "p": {"a": 0, "k": [30, 60, 0]},
            "a": {"a": 0, "k": [0, 0, 0]},
            "s": {"a": 1, "k": [{"t": 0, "s": [100, 50, 100], "e": [100, 100, 100]}, {"t": 40, "s": [100, 100, 100], "e": [100, 70, 100]}, {"t": 80}]}
          },
          "ao": 0,
          "shapes": [{
            "ty": "gr",
            "it": [{
              "ty": "rc",
              "d": 1,
              "s": {"a": 0, "k": [10, 40]},
              "p": {"a": 0, "k": [0, 0]},
              "r": {"a": 0, "k": 3},
              "nm": "Bar"
            }, {
              "ty": "fl",
              "c": {"a": 0, "k": [0.231, 0.510, 0.965, 1]},
              "o": {"a": 0, "k": 100},
              "nm": "Fill"
            }, {
              "ty": "tr",
              "p": {"a": 0, "k": [0, 0]},
              "a": {"a": 0, "k": [0, 0]},
              "s": {"a": 0, "k": [100, 100]},
              "r": {"a": 0, "k": 0},
              "o": {"a": 0, "k": 100}
            }],
            "nm": "Bar Group"
          }]
        }]
      };

      // Load animations
      if (document.getElementById('lottie-expense')) {
        lottie.loadAnimation({
          container: document.getElementById('lottie-expense'),
          renderer: 'svg',
          loop: true,
          autoplay: true,
          animationData: expenseAnimation
        });
      }

      if (document.getElementById('lottie-expense-desktop')) {
        lottie.loadAnimation({
          container: document.getElementById('lottie-expense-desktop'),
          renderer: 'svg',
          loop: true,
          autoplay: true,
          animationData: expenseAnimation
        });
      }

      if (document.getElementById('lottie-budget-desktop')) {
        lottie.loadAnimation({
          container: document.getElementById('lottie-budget-desktop'),
          renderer: 'svg',
          loop: true,
          autoplay: true,
          animationData: budgetAnimation
        });
      }

      if (document.getElementById('lottie-chart-desktop')) {
        lottie.loadAnimation({
          container: document.getElementById('lottie-chart-desktop'),
          renderer: 'svg',
          loop: true,
          autoplay: true,
          animationData: chartAnimation
        });
      }
    }

    // Dark Mode Toggle
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize Lottie animations
      initLottieAnimations();
      const html = document.documentElement;
      const lightRadio = document.querySelector('input[value="light"]');
      const darkRadio = document.querySelector('input[value="dark"]');
      
      // Check for saved theme preference or default to light
      const savedTheme = localStorage.getItem('theme') || 'light';
      
      // Apply saved theme on load
      if (savedTheme === 'dark') {
        html.classList.add('dark');
        if (darkRadio) darkRadio.checked = true;
      } else {
        html.classList.remove('dark');
        if (lightRadio) lightRadio.checked = true;
      }
      
      // Handle theme changes
      const themeRadios = document.querySelectorAll('input[name="theme"]');
      themeRadios.forEach(radio => {
        radio.addEventListener('change', function() {
          if (this.value === 'dark') {
            html.classList.add('dark');
            localStorage.setItem('theme', 'dark');
          } else {
            html.classList.remove('dark');
            localStorage.setItem('theme', 'light');
          }
        });
      });
    });
  </script>

  <script type="module" src="js/app.js"></script>
</body>
</html>
